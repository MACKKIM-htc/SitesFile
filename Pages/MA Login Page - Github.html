<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="UTF-8">
    <title>MA Login Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
	#popup-container { display: none; position: fixed; left: 0; top: 0; width: 100vw; height: 100vh; z-index: 99; justify-content: center; align-items: center; background-color: rgba(0,0,0,0.7);}
	.popup-content { background-color: #fefefe; height: 100%; width: 100%; position: relative;}
    </style>
  </head>
  <body style="padding: 0; margin: 0;height: 100vh; overflow: hidden;background-color: #343434;">
	<div id="popup-container">
		<div class="popup-content">        
			<iframe src="https://script.google.com/macros/s/AKfycbypcX2SR3pMDtwrSsqB8hjpi8LecYqvpXFfd5Xeuc0GNUT6nPx9erVO25Dw_qrhwVTV/exec" width="100%" height="100%" scrolling="no" style="border: none;" id="frame"></iframe>
		</div>
	</div>
	<script>
		const element = document.getElementById("popup-container");
		document.addEventListener('DOMContentLoaded', () => {
			alert(localStorage.getItem('dataUser'));
			if (localStorage.getItem('dataUser') !== null) {
				const dataUser = JSON.parse(localStorage.getItem('dataUser'));
				const savedDate = dataUser[0][30];
				const umur = Math.abs(new Date() - new Date(savedDate)) / 3600000;
				if (umur <24) {
					window.open(savedData[0][5], '_blank');
					window.close();
				} else {
					alert("Sesi Telah Berakhir. Silahkan Login Ulang");
					element.style.display = "flex";
				}
			} else {
				element.style.display = "flex";
			}
		});
		window.addEventListener('message', function(event) {
			const dataUser = JSON.parse(event.data);
			const hitung = dataUser[0].length;
			if (hitung == 32) {
				if (dataUser[0][31] =='Y') {
					localStorage.setItem('dataUser', JSON.stringify(dataUser));
				}
				window.top.location.href = dataUser[0][5];
				window.close();
			}
		});

	</script>

  </body>
  
</html>
